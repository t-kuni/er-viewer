---
description:
globs:
alwaysApply: true
---

# ER Diagram Viewer

RDBからER図をリバースエンジニアリングし、ブラウザ上で視覚的に表示・編集できるWebアプリケーション。

# 現状のフェーズ・基本方針

* アプリケーションを丸ごと作り直そうとしているので不要なコードが残っているケースあり
* プロトタイピング
* MVPを作る
* 実現可能性を検証したいのでパフォーマンスやセキュリティは考慮しない
* 余計な機能も盛り込まない
* 後方互換も考慮しない
* 不要になったコードは捨てる
* AIが作業するため学習コストは考慮不要

# 利用可能なコマンド

```bash
# 差分確認
git add -A && GIT_PAGER=cat git diff HEAD
# 直前のコミットの差分確認
GIT_PAGER=cat git diff HEAD^ HEAD

# コード生成（ビルドの前に実行すること）
# main.tspから生成した型が lib/generated/api-types.ts と public/src/api/client 配下に作成される
npm run generate

# テスト実行
npm run test
```

# アーキテクチャ概要

* `public`
  * フロントのコードが格納されている
* `spec`
  * 仕様書が格納されています
* `scheme`
  * APIのスキーマやJSON-Schemeが格納されています
* `scheme/main.tsp`
  * アプリ全体で利用する型を包括的に管理しています
  * これも仕様書として扱います
* `lib/generated/api-types.ts`
  * main.tspから生成されたバックエンド用の型です
* `public/src/api/client`
  * main.tspから生成されたフロント用の型です
  * ERDiagramViewModel でフロントのER図の状態を管理します

[rearchitecture_overview.md](/spec/rearchitecture_overview.md) にもアーキテクチャの説明あり。