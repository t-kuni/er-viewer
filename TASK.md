# npm test エラー解消タスク

## 高優先度タスク

### 設定・基盤修正
- [ ] ts-jest設定の非推奨警告を修正（isolatedModules設定をtsconfig.jsonに移行）
- [ ] Infrastructure Mockクラスでレイヤー関連のデータ形式を修正
- [ ] DOM Mock実装でsetTextContentメソッドを追加

### テスト修正
- [ ] Layer drag dropテストでDOM要素作成とイベント処理を修正
  - レイヤーアイテムのappendChild処理
  - draggable属性設定
  - ドラッグ&ドロップイベント処理
- [ ] User interactionテストでクリックイベント処理とDOM操作を修正
  - サイドバー表示・非表示機能
  - エンティティクリック処理
  - モーダル操作
- [ ] UI componentsテストで矩形・テキスト描画機能を修正
  - 矩形描画とSVG要素作成
  - テキスト入力フォーム処理
  - レイアウトデータ保存
- [ ] Renderingテストでエンティティ描画とクラスタリング機能を修正
  - エンティティ要素作成とDOM操作
  - 自動クラスタリング機能
  - レイヤー管理機能
- [ ] スキップしているテストを有効化する

### アプリケーション修正
- [ ] ERViewerApplicationクラスでレイヤー管理機能を実装・修正
  - レイヤー作成・表示機能
  - レイヤーのドラッグ&ドロップ機能
  - レイヤーとエンティティの関連付け

## 中優先度タスク

### 検証
- [ ] 全テストが通ることを確認（npm test実行）
- [ ] TypeScript型チェックが通ることを確認（npm run typecheck実行）

## エラー詳細

### 主なエラーパターン
1. **ts-jest設定警告**: isolatedModules設定の非推奨警告
2. **Infrastructure matchers**: レイヤーデータ形式の不一致
3. **Layer drag drop**: DOM要素作成・イベント処理エラー
4. **User interaction**: DOM操作・イベントハンドリングエラー
5. **UI components**: 矩形・テキスト描画機能エラー
6. **Rendering**: エンティティ描画・クラスタリング機能エラー

### 失敗テスト数
- 失敗: 24テスト
- スキップ: 3テスト
- 成功: 65テスト
- 合計: 92テスト

### 影響範囲
- 6つのテストスイートが失敗
- 3つのテストスイートが成功
- 主にDOM操作、イベント処理、データ形式に関連するエラー